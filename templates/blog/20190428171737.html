<h2>Perlの「Mojolicious」で「JSON」を描画する方法</h2>

Web APIを発行するときはJSONを使うのが便利。

PerlのMojoliciousを使って、JSONデータを描画してみよう。

<h3>renderメソッドでJSON描画</h3>

JSONを描画するにはMojolicious::Controllerクラスのrenderメソッドの<strong>json</strong>オプションを使用します。

<pre>
my $data = {name => 'Ken', age => 19};
$c->render(json => $data);
</pre>

Perlのデータを渡すとJSONとして描画されます。

<pre>
// JSON
{"name" : "Ken", "age" : 19}
</pre>

Perlのデータに含む文字列は内部文字列である必要があることに注意してください。Perlの内部文字列は自動的にUTF-8バイト文字列に変換されます。

以下はMojoliciousとMojolicious::Liteのサンプルです。

<h3> Mojolicious::Liteのサンプル</h3>

<pre>
<h3> Mojolicious::Lite</h3>
get '/' => sub {
  my $self = shift;
  my $data = {name => 'Ken', age => 19};
  $self->render(json => $data);
};

<h3> Mojoliciousのサンプル</h3>

<h3> Mojolicious</h3>
package MyApp::Picture;

use Mojo::Base 'Mojolicious::Controller';

sub json_data {
  my $self = shift;
  my $data = {name => 'Ken', age => 19};
  $self->render(json => $data);
}
</pre>
